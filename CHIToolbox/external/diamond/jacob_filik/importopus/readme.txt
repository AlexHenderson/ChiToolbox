This function was written by Jacob Filik and is free to use and
distribute, if you have any comments or suggestions, please contact:

jacob.filik@diamond.ac.uk
jacob.filik@gmail.com
